{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Choose Student</title>

  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome -->
  <!-- Font Awesome -->
  <link rel="stylesheet" href="{% static 'portal/plugins/fontawesome-free/css/all.min.css' %}">
  <!-- icheck bootstrap -->
  <link rel="stylesheet" href="{% static 'portal/plugins/icheck-bootstrap/icheck-bootstrap.min.css' %}">
  <!-- Theme style -->
  <link rel="stylesheet" href="{% static 'portal/dist/css/adminlte.min.css' %}">
  <link rel="icon" href="{% static 'portal/dist/img/AdminLTELogo.png' %}">

  <style>
    .flex-container
    {
        width: 90%;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap !important;
        margin: 0 auto;
        row-gap: 20px;
    }
    .flex-item
    {
        width: 30%;
    }
    .lockscreen-name
    {
        font-size: small;
        margin-left: 20px;
    }
    button  p
    {
        display: none;
    }
    .alert
    {
        width: 50%;
        margin: 10px auto;
    }
    .input-group input
    {
      text-align: center;
    }
    .lockscreen-logo a
    {
      color: blue;
          font-weight: bolder;
    }
    .lockscreen-logo a:hover 
    {
      color: black;
    }
    .lockscreen-logo
    {
      margin-bottom: 30px;
    }
    .wrapper
    {
      padding: 40px;
    }

    @media (max-width: 500px)
    {
        .flex-item
        {
            width: 100%;
        }

    }
  </style>
</head>
<body class="hold-transition lockscreen">
<!-- Automatic element centering -->
<div class="wrapper">
  <div class="lockscreen-logo">
    <a href="#"><b>Your Children</b></a>
  </div>
  <!-- User name -->
  {% if message %}
  <div class="alert alert-danger mt-2">{{message}}</div>
  {% endif %}
  <div class="flex-container">
    {% for child in children %}
    <div class="flex-item">
        <div class="lockscreen-name">{{child.name}}</div>
    
        <!-- START LOCK SCREEN ITEM -->
        <div class="lockscreen-item">
          <!-- lockscreen image -->
          <div class="lockscreen-image">
            <img src="{{ child.img }}" alt="User Image">
          </div>
          <!-- /.lockscreen-image -->
      
          <!-- lockscreen credentials (contains the form) -->
          <!-- <a href="{% url 'dashboard' child.id  %}"> -->
          <form class="lockscreen-credentials" method="" action="{% url 'dashboard' child.id %}">
            <div class="input-group">
              <input type="text" name="id" value="{{ child.id }}" class="form-control" placeholder="Admission Number" disabled>
      
              <div class="input-group-append">
                <a href="{% url 'dashboard' child.id %}"><button type="button" class="btn" title="Go to Child">
                  <i class="fas fa-arrow-right text-muted"></i>
                </button></a>
                
              </div>
            </div>
          </form>
          <!-- </a> -->
    
        <!-- /.lockscreen credentials -->
    
      </div> 
  </div>
 
  {% endfor %}
  </div>


  <!-- /.lockscreen-item -->
  <div class="help-block text-center">
    Choose child to continue
    <p class="mt-3 mb-1">
      <a href="{% url 'logout' %}">Log Out?</a>
    </p>
  </div>

</div>
<!-- /.center -->

<!-- jQuery -->
<script src="{% static 'portal/plugins/jquery/jquery.min.js' %}"></script>
<!-- Bootstrap 4 -->
<script src="{% static 'portal/plugins/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
<!-- AdminLTE App -->
<script src="{% static 'portal/dist/js/adminlte.min.js' %}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.20.0/jquery.validate.min.js"></script>

<!-- Add this script after including jQuery library -->

<script>
    $(document).ready(function() {
      // Get the value of the input field on button click
      $('.lockscreen-credentials button').on('click', function() {
        var enteredAdmissionNo = $('.lockscreen-credentials input').val();
  
        // Compare with Django variable {{ admission_no }}
        var innerHTMLOfP = $('.lockscreen-credentials button').parent().find('p').html();
        var successAlert = $(this).parent().siblings('.alert-success');
        var dangerAlert = $(this).parent().siblings('.alert-danger');
        
        var jsonString = innerHTMLOfP.replace(/'/g, '"');
        let id = $.parseJSON(jsonString).id

        if (enteredAdmissionNo == id) {
          // If the values match, redirect to the desired URL
          successAlert.show();
        dangerAlert.hide();
          window.location.href = "{% url 'dashboard' '$.id'%}"
        } else {
            successAlert.show();
        dangerAlert.hide();
          // If the values don't match, you can handle it accordingly
          $('.lockscreen-credentials').after('<div class="alert alert-danger mt-2">Incorrect Admission Number. Please try again.</div>');
        }
      });
    });
  </script>
  
</body>
</html>
